<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_xn0d5c7iept9-3{list-style-type:none}ul.lst-kix_yhz5mynw9ltc-1{list-style-type:none}ul.lst-kix_xn0d5c7iept9-4{list-style-type:none}ul.lst-kix_yhz5mynw9ltc-0{list-style-type:none}ul.lst-kix_xn0d5c7iept9-5{list-style-type:none}ul.lst-kix_yhz5mynw9ltc-3{list-style-type:none}ul.lst-kix_xn0d5c7iept9-6{list-style-type:none}ul.lst-kix_yhz5mynw9ltc-2{list-style-type:none}ul.lst-kix_yhz5mynw9ltc-5{list-style-type:none}ul.lst-kix_xn0d5c7iept9-0{list-style-type:none}ul.lst-kix_yhz5mynw9ltc-4{list-style-type:none}ul.lst-kix_xn0d5c7iept9-1{list-style-type:none}ul.lst-kix_yhz5mynw9ltc-7{list-style-type:none}ul.lst-kix_xn0d5c7iept9-2{list-style-type:none}ul.lst-kix_yhz5mynw9ltc-6{list-style-type:none}ul.lst-kix_yhz5mynw9ltc-8{list-style-type:none}ul.lst-kix_yunevkd3fyf7-6{list-style-type:none}ul.lst-kix_yunevkd3fyf7-7{list-style-type:none}ul.lst-kix_yunevkd3fyf7-8{list-style-type:none}ul.lst-kix_yunevkd3fyf7-2{list-style-type:none}ul.lst-kix_yunevkd3fyf7-3{list-style-type:none}ul.lst-kix_yunevkd3fyf7-4{list-style-type:none}ul.lst-kix_yunevkd3fyf7-5{list-style-type:none}ul.lst-kix_yunevkd3fyf7-0{list-style-type:none}ul.lst-kix_yunevkd3fyf7-1{list-style-type:none}.lst-kix_yunevkd3fyf7-6>li:before{content:"-  "}.lst-kix_yunevkd3fyf7-7>li:before{content:"-  "}.lst-kix_yunevkd3fyf7-8>li:before{content:"-  "}.lst-kix_yhz5mynw9ltc-8>li:before{content:"\0025a0  "}ul.lst-kix_xn0d5c7iept9-7{list-style-type:none}ul.lst-kix_xn0d5c7iept9-8{list-style-type:none}.lst-kix_yhz5mynw9ltc-4>li:before{content:"\0025cb  "}.lst-kix_xn0d5c7iept9-8>li:before{content:"\0025a0  "}.lst-kix_yunevkd3fyf7-0>li:before{content:"-  "}.lst-kix_yhz5mynw9ltc-3>li:before{content:"\0025cf  "}.lst-kix_yhz5mynw9ltc-7>li:before{content:"\0025cb  "}.lst-kix_xn0d5c7iept9-5>li:before{content:"\0025a0  "}.lst-kix_xn0d5c7iept9-4>li:before{content:"\0025cb  "}.lst-kix_xn0d5c7iept9-3>li:before{content:"\0025cf  "}.lst-kix_yhz5mynw9ltc-6>li:before{content:"\0025cf  "}.lst-kix_yunevkd3fyf7-5>li:before{content:"-  "}.lst-kix_yhz5mynw9ltc-5>li:before{content:"\0025a0  "}.lst-kix_yunevkd3fyf7-4>li:before{content:"-  "}.lst-kix_yhz5mynw9ltc-0>li:before{content:"\0025cf  "}.lst-kix_yunevkd3fyf7-2>li:before{content:"-  "}.lst-kix_yunevkd3fyf7-3>li:before{content:"-  "}.lst-kix_xn0d5c7iept9-6>li:before{content:"\0025cf  "}.lst-kix_xn0d5c7iept9-7>li:before{content:"\0025cb  "}.lst-kix_yhz5mynw9ltc-2>li:before{content:"\0025a0  "}.lst-kix_yunevkd3fyf7-1>li:before{content:"-  "}.lst-kix_yhz5mynw9ltc-1>li:before{content:"\0025cb  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_xn0d5c7iept9-1>li:before{content:"\0025cb  "}.lst-kix_xn0d5c7iept9-0>li:before{content:"\0025cf  "}.lst-kix_xn0d5c7iept9-2>li:before{content:"\0025a0  "}ol{margin:0;padding:0}table td,table th{padding:0}.c14{background-color:#2b2b2b;color:#6a8759;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Courier New";font-style:normal}.c12{background-color:#2b2b2b;color:#808080;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Courier New";font-style:normal}.c0{background-color:#2b2b2b;color:#a9b7c6;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Courier New";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c4{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c37{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c6{background-color:#2b2b2b;color:#9876aa;font-weight:400;font-size:10pt;font-family:"Courier New";font-style:italic}.c11{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-family:"Arial";font-style:normal}.c19{background-color:#2b2b2b;color:#6a8759;font-weight:700;font-size:10pt;font-family:"Courier New";font-style:normal}.c8{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c1{background-color:#2b2b2b;color:#9876aa;font-weight:700;font-size:10pt;font-family:"Courier New";font-style:italic}.c9{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-family:"Arial";font-style:normal}.c36{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:right}.c16{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#808080;font-weight:400}.c22{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#6a8759;font-weight:400}.c3{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#a9b7c6;font-weight:400}.c24{background-color:#2b2b2b;color:#6897bb;font-weight:400;font-size:10pt;font-family:"Courier New"}.c29{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#9876aa;font-weight:400}.c25{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#6a8759;font-weight:700}.c20{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#cc7832;font-weight:700}.c15{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#a9b7c6;font-weight:700}.c7{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#cc7832;font-weight:400}.c18{background-color:#2b2b2b;color:#ffc66d;font-weight:400;font-size:10pt;font-family:"Courier New"}.c27{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c33{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#9876aa}.c30{background-color:#2b2b2b;font-size:10pt;font-family:"Courier New";color:#6897bb}.c31{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c32{margin-left:72pt;padding-left:0pt}.c23{color:inherit;text-decoration:inherit}.c34{padding:0;margin:0}.c17{text-decoration:none;vertical-align:baseline}.c10{height:11pt}.c38{text-indent:36pt}.c35{padding-left:0pt}.c2{font-size:12pt}.c13{font-style:italic}.c21{font-style:normal}.c39{font-size:18pt}.c28{font-weight:700}.c26{margin-left:36pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c31 doc-content"><p class="c36"><span class="c5">Allison Fitzgerald, Trevor Martin, </span></p><p class="c36"><span class="c5">and Logan Reneau</span></p><p class="c10 c36"><span class="c5"></span></p><p class="c37"><span class="c11 c39">Trivia Game Tutorial</span></p><p class="c37"><span class="c2 c11">(On Device Data Storage on Android)</span></p><ul class="c34 lst-kix_xn0d5c7iept9-0 start"><li class="c8 c26 c35 li-bullet-0"><span class="c11 c2">Shared Storage</span></li><li class="c8 c35 c26 li-bullet-0"><span class="c11 c2">App specific storage</span></li><li class="c8 c35 c26 li-bullet-0"><span class="c11 c2">Preferences</span></li></ul><p class="c10 c37"><span class="c11 c2"></span></p><p class="c8"><span class="c2 c28">Overview</span><span class="c11 c2">: </span></p><p class="c8 c26"><span class="c11 c2">The platform focus in which we chose and were tasked to study was Data Storage. Specifically, on device options. To implement local data storage, we covered 3 of the 4 different ways to store data: App Specific Storage, Shared Storage, and Preference. We left out databases, as the project was small enough not to need a local database. </span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c26"><span class="c11 c2">Our app is a Trivia based game where the user will answer trivia questions with the goal to get the most amount possible in a row. There are three difficulty levels (easy, medium, and hard) that based on which you play gives you a certain amount of time to answer the questions, where you have decreasingly less time as the difficulty gets harder. </span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c26"><span class="c11 c2">We implemented the three local data storage options as followed: </span></p><ul class="c34 lst-kix_yhz5mynw9ltc-0 start"><li class="c8 c32 li-bullet-0"><span class="c11 c2">App Specific Storage: The app uses App Specific Storage by storing used questions from the user to keep track of which questions are available to avoid repeated questions.</span></li><li class="c8 c32 li-bullet-0"><span class="c11 c2">Shared Storage: The app uses Shared Storage by taking the stored streak data from our game, generating an image with the data on it, and saving it to the device to be able to share anywhere that allows photos!</span></li><li class="c8 c32 li-bullet-0"><span class="c11 c2">Preferences: The app uses Preferences to store streak data from the user and also to store the settings, for example the difficulty of the game. </span></li></ul><p class="c8 c26 c38"><span class="c11 c2">&nbsp;</span></p><p class="c8 c26"><span class="c11 c2">Below are some screenshots of the app!</span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c26"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 208.08px; height: 370.50px;"><img alt="" src="images/image1.png" style="width: 208.08px; height: 370.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 210.50px; height: 369.14px;"><img alt="" src="images/image5.png" style="width: 210.50px; height: 369.14px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8 c26"><span class="c11 c2">As seen in the screenshots above we have the home and question screens/activities.</span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8"><span class="c11 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Below we have the correct and incorrect answer screens/activities</span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c26"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 178.55px; height: 305.71px;"><img alt="" src="images/image4.png" style="width: 178.55px; height: 305.71px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 176.32px; height: 305.29px;"><img alt="" src="images/image6.png" style="width: 176.32px; height: 305.29px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8"><span class="c11 c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c8 c38"><span class="c11 c2">Finally, we have the settings and how to play screens/activities.</span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8 c26"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 189.57px; height: 341.60px;"><img alt="" src="images/image3.png" style="width: 189.57px; height: 341.60px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 189.50px; height: 343.17px;"><img alt="" src="images/image2.png" style="width: 189.50px; height: 343.17px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8 c26"><span class="c11 c2">The most common use case for users is to open the app, start the game, and try to beat their current longest streak. Other use cases include new users going through the how to play activities which explains the game to the user, going to the stats and downloading a picture to show off your streak, and going into the settings to change the difficulty of the game! </span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c2 c28">Getting Started</span><span class="c11 c2">: </span></p><p class="c8 c26"><span class="c11 c2">To get started, all you need to do is download Android Studio online and obtain a question list to implement into the app. We found one online after a quick google search in which we found a 2000 question list of trivia questions. The download link for android studio is below:</span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c26"><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://developer.android.com/studio&amp;sa=D&amp;source=editors&amp;ust=1670624192592131&amp;usg=AOvVaw3B6aetPOAflXC-0RbZDWWM">https://developer.android.com/studio</a></span></p><p class="c8 c26"><span class="c11 c2">Follow the prompts for download and select your device for installation. </span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c26"><span class="c2">Once in android studio, you do not need to download any third party utilities as we did not use any. It may be helpful to you if you downloaded a device with an API&gt;29 to help troubleshoot along the way. </span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c26"><span class="c11 c2">To learn about some of the topics we used outside of general kotlin see the links below. These links include an article on data storage and a great video describing the topic of data storage. &nbsp;</span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://developer.android.com/training/data-storage&amp;sa=D&amp;source=editors&amp;ust=1670624192593218&amp;usg=AOvVaw1v3lkyWw1AUe3r_btKiQHj">https://developer.android.com/training/data-storage</a></span></p><p class="c8"><span class="c2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://www.youtube.com/watch?v%3DRjyYCUW-9tY&amp;sa=D&amp;source=editors&amp;ust=1670624192593533&amp;usg=AOvVaw2_5f3G5wlzHd1CfQ8_MpTE">https://www.youtube.com/watch?v=RjyYCUW-9tY</a></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8 c26"><span class="c11 c2">We used, and recommend using, a language-centered environment as we wanted to focus on coding in kotlin. </span></p><p class="c8 c10 c26"><span class="c11 c2"></span></p><p class="c8 c26"><span class="c11 c2">Now that we have all of the tools and information we need, we can begin!</span></p><p class="c8 c10"><span class="c2 c9"></span></p><p class="c8"><span class="c9 c2">Step-by-step Tutorial:</span></p><p class="c8 c10"><span class="c9 c2"></span></p><p class="c8"><span class="c4">App-Specific Storage</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span>App-specific storage is a place where your app can store files that no other app or user on the device can access. This allows you to save information, especially in large quantities, that your app needs to persist across sessions. It also provides a great place to save information for which it would be problematic if anything other than your app were able to access and/or modify. One major thing to </span><span class="c13">avoid</span><span class="c5">&nbsp;placing into app-specific storage, however, is any data a user wants to retain when uninstalling your app, since app-specific storage is cleared when that happens.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">In this application, we needed a way to keep track of the questions that users had already answered to ensure no repeats would be given until absolutely necessary. This helps keep players from becoming too familiar with the question set and just memorizing answers. We also needed to ensure that no external user or app could change this data, since one could theoretically cheat by telling our app that we&rsquo;ve already used specific difficult questions, thus keeping them from appearing. App-specific storage is perfect for this use-case.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Initializing Our File</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">On the first run of our application, we need to make sure that the file exists in this app-specific storage area (specifically this is a directory called filesDir). There are a couple of ways to do this, but we chose to write the file using a stream. To do this, we&rsquo;ll use the following piece of code in our QuestionActivity file:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c6">applicationContext</span><span class="c3">.openFileOutput(</span><span class="c22">&quot;used&quot;</span><span class="c7">, </span><span class="c3">Context.</span><span class="c6">MODE_PRIVATE</span><span class="c3">).</span><span class="c18 c13">use </span></p><p class="c8"><span class="c15">&nbsp; &nbsp;{ it</span><span class="c3">.write(</span><span class="c22">&quot;&quot;</span><span class="c3">.</span><span class="c18 c13">toByteArray</span><span class="c3">()) </span><span class="c0">}</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">The first thing to note is that the applicationContext Context object contains the path to this filesDir directory, so we&rsquo;ll need to access it through that object. Using the openFileOutput method gives us a FileOutputStream pointed at the filesDir directory. The first argument passed in tells the name of the file we want to write to, in this case &ldquo;used.&rdquo; The second value sets the mode of operation. In this case, we use MODE_PRIVATE, which writes to the file and ensures that it is only visible by the app which called the function. </span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">From here we call the use method, which will use the stream to write to the file according to the function we&rsquo;ve passed in and then close the stream for us. The function we pass in simply writes an empty string to the file, so as to keep the file empty while ensuring it has been created. We&rsquo;ll need to use the toByteArray function so that the write method knows what to do with our data.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Writing To Our File</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Let&rsquo;s expand upon this now. Our question set is labeled numerically from 10000 to 11998. This is less because we thought that was a wise numbering scheme and more because that&rsquo;s how we found it when we got it, but we can make do with things the way they are. We&rsquo;ll randomly select a question to load into our activity with this code:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c7">var </span><span class="c3">currentQuestion = Random().nextInt(</span><span class="c24">1998</span><span class="c3">) + </span><span class="c24 c17 c21">10000</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Simple enough, this fetches a random number within our desired range. Once we&rsquo;ve loaded in the question though, we&rsquo;ll want to avoid repeating it later, so we&rsquo;ll write the number to our &ldquo;used&rdquo; file like this:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c6">applicationContext</span><span class="c3">.openFileOutput(</span><span class="c22">&quot;used&quot;</span><span class="c7">, </span><span class="c3">Context.</span><span class="c6">MODE_APPEND</span><span class="c3">).</span><span class="c18 c13">use </span><span class="c0">{</span></p><p class="c8"><span class="c15">&nbsp; &nbsp;it</span><span class="c3">.write((</span><span class="c22">&quot;</span><span class="c7">\n</span><span class="c22">&quot;</span><span class="c3">+(currentQuestion.toString())).</span><span class="c18 c13">toByteArray</span><span class="c3 c17 c21">())</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">We&rsquo;ve made two changes here from how we initialized our file. The first is to extend the string we&rsquo;re writing from a simple empty &ldquo;&rdquo; string to a newline character (to separate values) followed by the number we&rsquo;ve drawn. The second is to set our mode to MODE_APPEND. This retains the properties and contents of the file and simply adds the data onto the end of the existing contents. That ensures our file remains private and any data already written to it stays intact.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Maintaining State and Reading Our File</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Knowing this, we&rsquo;ve run into a bit of an issue. Our initialization at the top of our QuestionActivity will overwrite the contents of the file every single time we start it. Let&rsquo;s fix that by expanding the code used there, and while we&rsquo;re at it, let&rsquo;s also come up with a way of loading in our file:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c7">var </span><span class="c3">used: Array&lt;String&gt; = </span><span class="c3 c13">emptyArray</span><span class="c3 c17 c21">()</span></p><p class="c8"><span class="c7">val </span><span class="c3">files: Array&lt;String&gt; = </span><span class="c6">applicationContext</span><span class="c3 c17 c21">.fileList()</span></p><p class="c8"><span class="c7">if </span><span class="c3">(!files.</span><span class="c18 c13">contains</span><span class="c3">(</span><span class="c22">&quot;used&quot;</span><span class="c3 c17 c21">)) {</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c6">applicationContext</span><span class="c3">.openFileOutput(</span><span class="c22">&quot;used&quot;</span><span class="c7">, </span><span class="c3">Context.</span><span class="c6">MODE_PRIVATE</span><span class="c3">).</span><span class="c18 c13">use </span><span class="c0">{</span></p><p class="c8"><span class="c15">&nbsp; &nbsp; &nbsp; &nbsp;it</span><span class="c3">.write(</span><span class="c22">&quot;&quot;</span><span class="c3">.</span><span class="c18 c13">toByteArray</span><span class="c3 c17 c21">())</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c0">}</span></p><p class="c8"><span class="c3">} </span><span class="c7">else </span><span class="c3 c17 c21">{</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c7">val </span><span class="c3">reader: BufferedReader = </span><span class="c6">applicationContext</span><span class="c3">.openFileInput(</span><span class="c22">&quot;used&quot;</span><span class="c3">).</span><span class="c18 c13">bufferedReader</span><span class="c3 c17 c21">()</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;used = reader.</span><span class="c13 c18">readLines</span><span class="c3">().</span><span class="c18 c13">toTypedArray</span><span class="c3 c17 c21">()</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;reader.close()</span></p><p class="c8"><span class="c3 c17 c21">}</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Just above the if block, we use the fileList method to get an array of all files in the filesDir directory. Then, as the condition on our if, we check if that array contains our filename. If so, we know that it already exists, so we don&rsquo;t want to initialize it and instead skip to the else block. If not, we do the same initialization as before.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span>In the else block, we use the openFileInput method to open a stream on our file, then use the bufferedReader method to create a BufferedReader on that stream. We then read line-by-line the contents of our file into the empty array declared at the top. Because of the way we went about doing things earlier, our data is already separated with newline characters, which makes this work out okay. Finally, we close the stream manually, since we don&rsquo;t have the use method to do that for us. </span><span class="c13">Note that this may be wildly inefficient on especially large files, but since we are capped at 1999 lines, we&rsquo;ll be okay.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Dealing With The Data:</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">There&rsquo;s only a few things left to consider. First, we have an issue in that the first value of our array will always be empty thanks to our insistence on writing newline characters before our values. This might be easy to work around, but it&rsquo;s not necessarily elegant. Second, we have to worry about what to do when we encounter a repeat question, or when we run out of questions to use. Let&rsquo;s expand on our code to write to the file to handle this logic:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c7">var </span><span class="c3">currentQuestion = Random().nextInt(</span><span class="c24">1998</span><span class="c3">) + </span><span class="c17 c21 c24">10000</span></p><p class="c8 c10"><span class="c24 c17 c21"></span></p><p class="c8"><span class="c7">var </span><span class="c3">unusedQuestion = </span><span class="c7 c17 c21">false</span></p><p class="c8 c10"><span class="c7 c17 c21"></span></p><p class="c8"><span class="c7">while </span><span class="c3 c17 c21">(!unusedQuestion) {</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c12">/* If used list is empty, write question to used list. This is a separate</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; condition so that the first line is not a newline character, which can</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; mess with the count. Probably a better way of doing this but who really</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; cares if it works, eh? */</span></p><p class="c8"><span class="c16">&nbsp; &nbsp;</span><span class="c7">if </span><span class="c3">(used.</span><span class="c18 c13">isEmpty</span><span class="c3 c17 c21">()) {</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">applicationContext</span><span class="c3">.openFileOutput(</span><span class="c22">&quot;used&quot;</span><span class="c7">, </span><span class="c3">Context.</span><span class="c6">MODE_APPEND</span><span class="c3">).</span><span class="c18 c13">use </span><span class="c0">{</span></p><p class="c8"><span class="c15">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;it</span><span class="c3">.write(currentQuestion.toString().</span><span class="c18 c13">toByteArray</span><span class="c3 c17 c21">())</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">}</span></p><p class="c8"><span class="c15">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">unusedQuestion = </span><span class="c7 c17 c21">true</span></p><p class="c8"><span class="c7">&nbsp; &nbsp;</span><span class="c12">/* If question is not in used list, question is unused. Write question</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; to used list, then flag the question as unused to exit the loop. */</span></p><p class="c8"><span class="c16">&nbsp; &nbsp;</span><span class="c3">} </span><span class="c7">else if </span><span class="c3">(!used.</span><span class="c18 c13">contains</span><span class="c3 c17 c21">(currentQuestion.toString())) {</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">applicationContext</span><span class="c3">.openFileOutput(</span><span class="c22">&quot;used&quot;</span><span class="c7">, </span><span class="c3">Context.</span><span class="c6">MODE_APPEND</span><span class="c3">).</span><span class="c18 c13">use </span><span class="c0">{</span></p><p class="c8"><span class="c15">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;it</span><span class="c3">.write((</span><span class="c22">&quot;</span><span class="c7">\n</span><span class="c22">&quot;</span><span class="c3">+(currentQuestion.toString())).</span><span class="c18 c13">toByteArray</span><span class="c3 c17 c21">())</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">}</span></p><p class="c8"><span class="c15">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">unusedQuestion = </span><span class="c7 c17 c21">true</span></p><p class="c8 c10"><span class="c7 c17 c21"></span></p><p class="c8"><span class="c7">&nbsp; &nbsp;</span><span class="c12">/* If the question has been used and there are still unused questions</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; remaining, add one to the current value, then loop again. Modular</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; division to ensure that we loop from 11998 back to 10000. Find a</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; more efficient way to do this. Hashing algorithms from 263 maybe</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; helpful? */</span></p><p class="c8"><span class="c16">&nbsp; &nbsp;</span><span class="c3">} </span><span class="c7">else if </span><span class="c3">(used.</span><span class="c29">size </span><span class="c3">&lt; </span><span class="c24">1999</span><span class="c3 c17 c21">) {</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;currentQuestion = (((currentQuestion-</span><span class="c24">10000</span><span class="c3">)+</span><span class="c24">1</span><span class="c3">)%</span><span class="c24">1999</span><span class="c3">)+</span><span class="c24 c17 c21">10000</span></p><p class="c8 c10"><span class="c24 c17 c21"></span></p><p class="c8"><span class="c24">&nbsp; &nbsp;</span><span class="c12">/* If we&#39;ve already used the question but we have no more unused questions,</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; blank the used questions file, blank the array, then loop again to write</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; as used. */</span></p><p class="c8"><span class="c16">&nbsp; &nbsp;</span><span class="c3">} </span><span class="c7">else </span><span class="c3 c17 c21">{</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">applicationContext</span><span class="c3">.openFileOutput(</span><span class="c22">&quot;used&quot;</span><span class="c7">, </span><span class="c3">Context.</span><span class="c6">MODE_PRIVATE</span><span class="c3">).</span><span class="c18 c13">use </span><span class="c0">{</span></p><p class="c8"><span class="c15">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;it</span><span class="c3">.write(</span><span class="c22">&quot;&quot;</span><span class="c3">.</span><span class="c18 c13">toByteArray</span><span class="c3 c17 c21">())</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">}</span></p><p class="c8"><span class="c15">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">used = </span><span class="c3 c13">emptyArray</span><span class="c3 c17 c21">()</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;}</span></p><p class="c8"><span class="c3 c17 c21">}</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span>First, note that the value &ldquo;used&rdquo; is the array from earlier that we loaded our file into, </span><span class="c13">not</span><span class="c5">&nbsp;the file itself. Consequently, any methods or properties used or accessed on it are Array methods/properties.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Let&rsquo;s run through this step by step. Within our while loop are four conditions. The if statement checks if &ldquo;used&rdquo; is empty before executing. If so, we know that no questions have yet been used and we are free to write the question we&rsquo;ve drawn to the file. Notice that this is the same write-to-file code from earlier but without the newline character, since it&rsquo;s going to be the first line of the file. This eliminates the &ldquo;first element of the Array is empty&rdquo; problem. We also flag that our question was unused to escape the loop.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span>If we </span><span class="c13">have</span><span class="c5">&nbsp;used questions before, then our first else-if condition will check if the value we&rsquo;ve drawn has already been used. Note the toString call, since our array is an array of Strings. If the question is unused, then we&rsquo;ll execute the original write-to-file code we came up with earlier, adding the new value as the next line of the file. We&rsquo;ll also once again flag the question as unused.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span>Our second else-if will only be reached if we&rsquo;ve already used the question we&rsquo;ve drawn, but there is a possibility that we&rsquo;ve actually used </span><span class="c13">all</span><span class="c5">&nbsp;of our questions. The condition on this block, then, checks that we still have questions to go. Since our questions are numbered 10000-11998, a full array containing all values would be 1999 values long, so we check to ensure that our size is less than that. If so, we simply increment the value by one, ensuring that we loop back to 10000 if we&rsquo;re out of range, and loop again. While this isn&rsquo;t the most efficient way of going about things, on a data set this small, even a worst case scenario of looping from 10000 to 11998 doesn&rsquo;t produce noticeable slowdown.</span></p><p class="c8"><span class="c5">Finally, if we&rsquo;re out of questions, we&rsquo;ll simply re-initialize the file to clear the data and empty our array as well, then loop again to write the question as used and start the cycle over again.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Shared Preferences</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">Preferences are the way to store simple data, such as integers, strings, string lists, and booleans. Everything in preferences is stored as a key-value pair. This data will persist even if the app is closed. It is stored in a shared preference file, which is not directly accessible by the programmer. In this application, we stored 3 things as preferences: the current question streak, the greatest streak record, and the difficulty setting. </span></p><p class="c8"><span class="c5">&nbsp;</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Initializing Shared Preferences</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">In the Main Activity:</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c20">val </span><span class="c15">sPref = </span><span class="c1">applicationContext</span><span class="c15">.getSharedPreferences(</span><span class="c25">&quot;MyPref&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8"><span class="c20">val </span><span class="c0">editor: SharedPreferences.Editor = sPref.edit()</span></p><p class="c8"><span class="c20">if </span><span class="c15">(!(sPref.contains(</span><span class="c25">&quot;currentStreak&quot;</span><span class="c0">))){</span></p><p class="c8"><span class="c15">&nbsp; &nbsp;editor.putInt(</span><span class="c25">&quot;currentStreak&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8"><span class="c15">&nbsp; &nbsp;editor.putInt(</span><span class="c25">&quot;maxStreak&quot;</span><span class="c20">, </span><span class="c28 c30">0</span><span class="c0">)</span></p><p class="c8"><span class="c0">&nbsp; &nbsp;editor.apply()</span></p><p class="c8"><span class="c0">}</span></p><p class="c8"><span class="c20">if </span><span class="c15">(!(sPref.contains(</span><span class="c25">&quot;diffValue&quot;</span><span class="c0">))){</span></p><p class="c8"><span class="c15">&nbsp; &nbsp;editor.putString(</span><span class="c25">&quot;diffValue&quot;</span><span class="c20">, </span><span class="c25">&quot;Easy&quot;</span><span class="c0">)</span></p><p class="c8"><span class="c0">&nbsp; &nbsp;editor.apply()</span></p><p class="c8"><span class="c0">}</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">This code is in the main method. The first time you save a piece of data to shared preferences, it will create the key if it does not yet exist. However, in order to control when that key is created, I added this to the main activity. It checks if there is a key in the shared preference file, and if there is not, it creates one and saves starter values. It will only run the first time the app is run on a device.</span></p><p class="c8"><span class="c5">sPref is used to access the shared preference file, which in the command is named &ldquo;myPref&rdquo;. The zero means it is a private file, as you can have private and public ones.</span></p><p class="c8"><span class="c5">The editor value allows you to edit the shared preference value that you created/accessed when instantiating sPref.</span></p><p class="c8"><span class="c5">In the if statements, the editor is used to add key-value pairs if they do not already exist. We are creating a currentStreak key and a maxStreak key and putting in the value 0. We can do this both in the same if statement because if no currentStreak exists, then there is not a max streak. The second if statement does not necessarily need to be separate from the first, it is just written that way as it is not related to the other key-value pairs.</span></p><p class="c8"><span class="c5">In order for the changes to be written to the shared preferences file, you must include edit.apply() after your edits. If you do not do this, the edits you make to the values will not be saved.</span></p><p class="c8"><span class="c5">It is necessary to create a variable like sPref that allows access to the shared preferences files whenever you need to grab saved information. It is also necessary to create an editor variable whenever the data in shared preferences needs to be updated.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Using Shared Preferences</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span>In the Question Activity:</span></p><p class="c8"><span class="c20">var </span><span class="c15">difficulty: String? = sPref.getString(</span><span class="c25">&quot;diffValue&quot;</span><span class="c20">, </span><span class="c25">&quot;Easy&quot;</span><span class="c0">)</span></p><p class="c8"><span class="c4">&hellip;</span></p><p class="c8"><span class="c20">if</span><span class="c15">(difficulty == </span><span class="c25">&quot;Easy&quot;</span><span class="c0">) {</span></p><p class="c8"><span class="c4">// progress bar code </span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">The difficulty variable is set to whatever value is saved in the &ldquo;diff value&rdquo; key. &ldquo;Easy&rdquo; is set as the default value in case nothing is saved in the key, which should not be the case due to the initialization in the home screen, but is still necessary to include.</span></p><p class="c8"><span class="c5">The difficulty variable is used in the progress bar and controls how fast the bar goes down. There are 3 if statements for each difficulty level.</span></p><p class="c8"><span class="c7">var </span><span class="c3">currentStreak = sPref.getInt(</span><span class="c22">&quot;currentStreak&quot;</span><span class="c7">, </span><span class="c24">0</span><span class="c3 c17 c21">)</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c3">answerAButton.setOnClickListener</span><span class="c0">{</span></p><p class="c8"><span class="c15">&nbsp; &nbsp;</span><span class="c3">aIsClicked = </span><span class="c7 c17 c21">true</span></p><p class="c8"><span class="c7">&nbsp; &nbsp;if</span><span class="c3">(correctAnswer == </span><span class="c22">&quot;A&quot; </span><span class="c3 c17 c21">){</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">//updating the current streak</span></p><p class="c8"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">currentStreak += </span><span class="c24 c17 c21">1</span></p><p class="c8"><span class="c24">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">editor.putInt(</span><span class="c22">&quot;currentStreak&quot;</span><span class="c7">, </span><span class="c3 c17 c21">currentStreak)</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp; &nbsp; &nbsp;editor.apply()</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">val </span><span class="c3">i = Intent(</span><span class="c7">this, </span><span class="c3">CorrectAnswerActivity::</span><span class="c7">class</span><span class="c3">.</span><span class="c6">java</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp; &nbsp; &nbsp;startActivity(i)</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;}</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c7">else </span><span class="c3 c17 c21">{</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">val </span><span class="c3">i = Intent(</span><span class="c7">this, </span><span class="c3">WrongAnswerActivity::</span><span class="c7">class</span><span class="c3">.</span><span class="c6">java</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp; &nbsp; &nbsp;startActivity(i)</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;}</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;finish()</span></p><p class="c8"><span class="c0">}</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">A variable is declared that holds the current value saved in shared preferences. In each answer button listener, there is an if statement that is taken if the answer selected was the correct answer. If this if statement is taken, the currentStreak variable is incremented by one, and then set as the currentStreak key&rsquo;s value.</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">In the Correct Answer Activity:</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c20">val </span><span class="c15">currentStreakSaved = sPref.getInt(</span><span class="c25">&quot;currentStreak&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8 c10"><span class="c0"></span></p><p class="c8"><span class="c1">title </span><span class="c15">= </span><span class="c25">&quot;Question </span><span class="c20">$</span><span class="c15">currentStreakSaved</span><span class="c19 c17">&quot;</span></p><p class="c8 c10"><span class="c19 c17"></span></p><p class="c8"><span class="c15">currentStreak.</span><span class="c1">text </span><span class="c15">= </span><span class="c25">&quot;Current Streak: </span><span class="c20">$</span><span class="c15">currentStreakSaved</span><span class="c17 c19">&nbsp;questions&quot;</span></p><p class="c8"><span class="c20">var </span><span class="c15">longestStreakSaved = sPref.getInt(</span><span class="c25">&quot;maxStreak&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8"><span class="c20">if </span><span class="c0">(currentStreakSaved &gt; longestStreakSaved) {</span></p><p class="c8"><span class="c0">&nbsp; &nbsp;longestStreakSaved = currentStreakSaved</span></p><p class="c8"><span class="c15">&nbsp; &nbsp;editor.putInt(</span><span class="c25">&quot;maxStreak&quot;</span><span class="c20">, </span><span class="c0">longestStreakSaved)</span></p><p class="c8"><span class="c0">&nbsp; &nbsp;editor.apply()</span></p><p class="c8"><span class="c0">}</span></p><p class="c8"><span class="c15">longestStreak.</span><span class="c1">text </span><span class="c15">= </span><span class="c25">&quot;Longest Streak: </span><span class="c20">$</span><span class="c15">longestStreakSaved</span><span class="c19 c17">&nbsp;questions&quot;</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">This screen is only reached when you got the answer correct. This means that the current streak has already been updated in the previous question screen, so it does not be to be updated here. In this activity, all that needs to be done is to assign the stored data to a variable so the data can be displayed as text. The if statement checks whether or not the currentStreak is greater than the maxStreak (saved as longestStreakSaved), and if it is, the longestStreakSaved is updated. That value is then saved with the maxStreak key using the editor.</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">In the Wrong Answer Activity:</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c20">val </span><span class="c15">finalStreakSaved = sPref.getInt(</span><span class="c25">&quot;currentStreak&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8"><span class="c20">val </span><span class="c15">longestStreakSaved = sPref.getInt(</span><span class="c25">&quot;maxStreak&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8 c10"><span class="c0"></span></p><p class="c8"><span class="c1">title </span><span class="c15">= </span><span class="c25">&quot;Question &quot; </span><span class="c15">+ (finalStreakSaved + </span><span class="c30 c28">1</span><span class="c0">)</span></p><p class="c8 c10"><span class="c0"></span></p><p class="c8"><span class="c15">finalStreak.</span><span class="c1">text </span><span class="c15">= </span><span class="c25">&quot;Final Streak: </span><span class="c20">$</span><span class="c15">finalStreakSaved</span><span class="c19 c17">&nbsp;questions&quot;</span></p><p class="c8"><span class="c15">longestStreak.</span><span class="c1">text </span><span class="c15">= </span><span class="c25">&quot;Lonqest Streak: </span><span class="c20">$</span><span class="c15">longestStreakSaved</span><span class="c19 c17">&nbsp;questions&quot;</span></p><p class="c8"><span class="c15">editor.putInt(</span><span class="c25">&quot;currentStreak&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8"><span class="c0">editor.apply()</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">This code is put at the beginning of the onCreate method. It puts the final streak and max streak that are saved in shared preferences into the finalStreakSaved and longestStreakSaved variables in order to display them. In order to display the question number correctly, we add one to the finalStreakSaved variable, because, unlike the correct answer activity, the streak is not incremented in the question activity. The player got the answer wrong, so the current streak must be reset to 0, which is done by the editor. </span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">In the Settings Activity:</span></p><p class="c8"><span class="c20">val </span><span class="c15">sPref = </span><span class="c1">applicationContext</span><span class="c15">.getSharedPreferences(</span><span class="c25">&quot;MyPref&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8"><span class="c20">val </span><span class="c0">editor: SharedPreferences.Editor = sPref.edit()</span></p><p class="c8 c10"><span class="c0"></span></p><p class="c8"><span class="c28 c33">diffSelection </span><span class="c15">= sPref.getString(</span><span class="c25">&quot;diffValue&quot;</span><span class="c20">, </span><span class="c25">&quot;Easy&quot;</span><span class="c0">)</span></p><p class="c8 c10"><span class="c0"></span></p><p class="c8"><span class="c15">findViewById&lt;FloatingActionButton&gt;(R.id.</span><span class="c1">fab</span><span class="c0">).setOnClickListener { view -&gt;</span></p><p class="c8"><span class="c15">&nbsp; &nbsp;editor.putString(</span><span class="c25">&quot;diffValue&quot;</span><span class="c20">, </span><span class="c33 c28">diffSelection</span><span class="c0">)</span></p><p class="c8"><span class="c0">&nbsp; &nbsp;editor.apply()</span></p><p class="c8 c10"><span class="c0"></span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">This code is near the top of the onCreate method. diffSelection, a private variable declared at the top of the class, represents the value selected by the spinner. In order for the spinner to display the current setting, diffSelection is set to the current values saved in the &ldquo;diffValue&rdquo; key in saved preferences. Then, if the user changes a setting, diffSelection will change to what the user selected. So then when the check mark button is clicked, the setting the user selected is saved into shared preferences. </span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c4">In the Stats Activity:</span></p><p class="c8"><span class="c20">val </span><span class="c15">myStreak = sPref.getInt(</span><span class="c25">&quot;currentStreak&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8"><span class="c20">val </span><span class="c15">bestStreak = sPref.getInt(</span><span class="c25">&quot;maxStreak&quot;</span><span class="c20">, </span><span class="c30 c28">0</span><span class="c0">)</span></p><p class="c8"><span class="c15">streakValue.</span><span class="c1">text </span><span class="c15">= </span><span class="c25">&quot;</span><span class="c20">$</span><span class="c15">myStreak</span><span class="c19 c17">&quot;</span></p><p class="c8"><span class="c15">longestStreak.</span><span class="c1">text </span><span class="c15">= </span><span class="c25">&quot;</span><span class="c20">$</span><span class="c15">bestStreak</span><span class="c19 c17">&quot;</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span>Shared preferences are only used to get data to display in this activity. It simply grabs the current data stored in the currentStreak and maxStreak keys and assigns them to values that will be displayed</span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c4">Shared Storage and Media</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">While app-specific storage is great for private content, suppose our app wanted to produce content that can be seen by users and other applications outside the app. This is where shared storage comes into play. Shared storage allows your app to contribute data to a pool easily accessed by other sources, and since this is often done with media (photos, videos, etc), this will often be done in conjunction with the MediaStore API.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Within our app, we generated images containing a summary of a user&rsquo;s stats for a game. Though statistics are already presented within the app, the idea would be that the user could share these images to their friends on social media, so this presented a perfect opportunity to use shared storage.</span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c4">Generating Shareable Images:</span></p><p class="c8"><span class="c5">Actually generating the media is beyond the scope of this tutorial, since it has less to do with the storage APIs and more to do with the Paint and Canvas classes. Nevertheless, if you don&rsquo;t have media files to work with already, we&rsquo;ll list the code we used to generate our images here so you can follow along:</span></p><p class="c8 c10"><span class="c12"></span></p><p class="c8"><span class="c7">var </span><span class="c3">source = BitmapFactory.decodeResource(</span><span class="c6">resources</span><span class="c7">, </span><span class="c3">R.drawable.</span><span class="c6">endcard</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">var </span><span class="c3 c17 c21">saved: Bitmap =</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;Bitmap.createBitmap(source.</span><span class="c6">width</span><span class="c7">, </span><span class="c3">source.</span><span class="c6">height</span><span class="c7">, </span><span class="c3">Bitmap.Config.</span><span class="c6">ARGB_8888</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">val </span><span class="c3 c17 c21">cal = Calendar.getInstance()</span></p><p class="c8"><span class="c7">val </span><span class="c3">year = cal.get(Calendar.</span><span class="c6">YEAR</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">val </span><span class="c3">month = cal.get(Calendar.</span><span class="c6">MONTH</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">val </span><span class="c3">day = cal.get(Calendar.</span><span class="c6">DAY_OF_MONTH</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">val </span><span class="c3">hour = cal.get(Calendar.</span><span class="c6">HOUR_OF_DAY</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">val </span><span class="c3">minute = cal.get(Calendar.</span><span class="c6">MINUTE</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">val </span><span class="c3">second = cal.get(Calendar.</span><span class="c6">SECOND</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">val </span><span class="c3">diffNum = sPref.getInt(</span><span class="c22">&quot;currentDifficulty&quot;</span><span class="c7">, </span><span class="c24">0</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">val </span><span class="c3 c17 c21">diff : String</span></p><p class="c8"><span class="c7">if </span><span class="c3">(diffNum == </span><span class="c24">1</span><span class="c3 c17 c21">) {</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;diff = getString(R.string.</span><span class="c6">Medium</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c3">} </span><span class="c7">else if </span><span class="c3">(diffNum == </span><span class="c24">2</span><span class="c3 c17 c21">) {</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;diff = getString(R.string.</span><span class="c6">Hard</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c3">} </span><span class="c7">else </span><span class="c3 c17 c21">{</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;diff = getString(R.string.</span><span class="c6">Easy</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c3 c17 c21">}</span></p><p class="c8"><span class="c7">val </span><span class="c3">imgHeader = &nbsp;getString(R.string.</span><span class="c6">Stats_For_Today</span><span class="c3">) + </span><span class="c22">&quot; </span><span class="c7">$</span><span class="c3">year</span><span class="c22">-</span><span class="c7">$</span><span class="c3">month</span><span class="c22">-</span><span class="c7">$</span><span class="c3">day</span><span class="c14">:&quot;</span></p><p class="c8"><span class="c7">val </span><span class="c3">streakText = getString(R.string.</span><span class="c6">Today_Streak</span><span class="c3">) + </span><span class="c22">&quot; &quot; </span><span class="c3 c17 c21">+ finalStreakSaved</span></p><p class="c8"><span class="c7">val </span><span class="c3">bestText = &nbsp;getString(R.string.</span><span class="c6">Longest_Streak</span><span class="c3">) + </span><span class="c22">&quot; &quot; </span><span class="c3 c17 c21">+ longestStreakSaved</span></p><p class="c8"><span class="c7">val </span><span class="c3">timerOn = getString(R.string.</span><span class="c6">Difficulty</span><span class="c3">) + </span><span class="c22">&quot; &quot; </span><span class="c3 c17 c21">+ diff</span></p><p class="c8 c10"><span class="c3 c17 c21"></span></p><p class="c8 c10"><span class="c3 c17 c21"></span></p><p class="c8"><span class="c7">var </span><span class="c3 c17 c21">canvas = Canvas(saved)</span></p><p class="c8"><span class="c7">var </span><span class="c3 c17 c21">paint = Paint()</span></p><p class="c8"><span class="c3">paint.</span><span class="c6">textSize </span><span class="c3">= </span><span class="c24 c17 c21">120F</span></p><p class="c8"><span class="c3">paint.</span><span class="c6">color </span><span class="c3">= Color.</span><span class="c6 c17">GREEN</span></p><p class="c8"><span class="c3">paint.</span><span class="c6">style </span><span class="c3">= Paint.Style.</span><span class="c6 c17">FILL</span></p><p class="c8"><span class="c3">canvas.drawBitmap(source</span><span class="c7">, </span><span class="c24">0f</span><span class="c7">, </span><span class="c24">0F</span><span class="c7">, null</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c7">val </span><span class="c3">height = paint.measureText(</span><span class="c22">&quot;yY&quot;</span><span class="c3">) + </span><span class="c24 c17 c21">1100F</span></p><p class="c8"><span class="c7">val </span><span class="c3 c17 c21">width = paint.measureText(imgHeader)</span></p><p class="c8"><span class="c7">val </span><span class="c3">x = (source.</span><span class="c6">width </span><span class="c3">- width) / </span><span class="c24 c17 c21">2</span></p><p class="c8"><span class="c3">canvas.drawText(imgHeader</span><span class="c7">, </span><span class="c3">x</span><span class="c7">, </span><span class="c3">height</span><span class="c7">, </span><span class="c3 c17 c21">paint)</span></p><p class="c8"><span class="c3">canvas.drawText(streakText</span><span class="c7">, </span><span class="c3">x</span><span class="c7">, </span><span class="c3">height + </span><span class="c24">150F</span><span class="c7">, </span><span class="c3 c17 c21">paint)</span></p><p class="c8"><span class="c3">canvas.drawText(bestText</span><span class="c7">, </span><span class="c3">x</span><span class="c7">, </span><span class="c3">height + </span><span class="c24">300F</span><span class="c7">, </span><span class="c3 c17 c21">paint)</span></p><p class="c8"><span class="c3">canvas.drawText(timerOn</span><span class="c7">, </span><span class="c3">x</span><span class="c7">, </span><span class="c3">height + </span><span class="c24">450F</span><span class="c7">, </span><span class="c3 c17 c21">paint)</span></p><p class="c8 c10"><span class="c3 c17 c21"></span></p><p class="c8"><span class="c5">Most of this is adapted from a StackOverflow post, which we have linked in our Resources section below if you&rsquo;d like to see where we got the idea from. The important parts to note are as follows:</span></p><ul class="c34 lst-kix_yunevkd3fyf7-0 start"><li class="c8 c35 c26 li-bullet-0"><span class="c5">R.drawable.endcard is an image we had in our project&rsquo;s &ldquo;res&rdquo; directory already, which we converted to a Bitmap using the createBitmap method.</span></li><li class="c8 c35 c26 li-bullet-0"><span class="c5">We use several string resources throughout this code segment, but you can put whatever text you like in there and it&rsquo;ll work just as well.</span></li></ul><p class="c8"><span class="c5">Once you have your image available to you as a Bitmap, we can move on.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Using The MediaStore API To Prepare To Save Files (Android 10+):</span></p><p class="c8"><span class="c5">When it comes to shared storage, the MediaStore is our best friend. MediaStore is a way to interface with media of different types in a single place, allowing all apps to communicate with the same language and ensuring that private information about where things are actually stored is kept from applications that don&rsquo;t need that information. To start with, let&rsquo;s take a look at the code to add our image to the MediaStore:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c7">val </span><span class="c3">resolver = </span><span class="c6 c17">contentResolver</span></p><p class="c8"><span class="c7">val </span><span class="c3 c17 c21">values = ContentValues()</span></p><p class="c8"><span class="c3">values.put(MediaStore.MediaColumns.</span><span class="c6">DISPLAY_NAME</span><span class="c7">, </span><span class="c22">&quot;TriviaStats_</span><span class="c7">$</span><span class="c3">year</span><span class="c7">$</span><span class="c3">month</span><span class="c7">$</span><span class="c3">day</span><span class="c22">&quot; </span><span class="c3 c17 c21">+</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c22">&quot;_&quot; </span><span class="c3">+ </span><span class="c22">&quot;</span><span class="c7">$</span><span class="c3">hour</span><span class="c7">$</span><span class="c3">minute</span><span class="c7">$</span><span class="c3">second</span><span class="c22">.jpg&quot;</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c3">values.put(MediaStore.MediaColumns.</span><span class="c6">MIME_TYPE</span><span class="c7">, </span><span class="c22">&quot;image/jpeg&quot;</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c3 c17 c21">values.put(</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;MediaStore.MediaColumns.</span><span class="c6">RELATIVE_PATH</span><span class="c7">, </span><span class="c3">Environment.</span><span class="c6">DIRECTORY_PICTURES </span><span class="c3 c17 c21">+</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;File.</span><span class="c6">separator </span><span class="c3">+ </span><span class="c14">&quot;357Project&quot;</span></p><p class="c8"><span class="c3 c17 c21">)</span></p><p class="c8 c10"><span class="c3 c17 c21"></span></p><p class="c8"><span class="c7">val </span><span class="c3">uri = resolver.insert(MediaStore.Images.Media.</span><span class="c6">EXTERNAL_CONTENT_URI</span><span class="c7">, </span><span class="c3 c17 c21">values)</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">To start, we create a new ContentValues called &ldquo;values.&rdquo; This is going to store important information about our file - things like filename, extension, and path - that MediaStore will need to know. Each call to the put method adds another piece of information to &ldquo;values&rdquo; in a key/value pair. The first call inserts a filename. By using the MediaStore.MediaColumns.DISPLAY_NAME as our key, the MediaStore will later understand that the value is supposed to be a filename. The second put stores data that will tell the MediaStore what type of file this is. In this case, we have an image file of type &ldquo;jpeg,&rdquo; so we use the value &ldquo;image/jpeg.&rdquo;</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Our final put is a bit more complex. This will tell the MediaStore where we want the file to go. Environment.DIRECTORY_PICTURES gives a path to our device&rsquo;s &ldquo;Pictures&rdquo; directory. To the end of that, we add what is typically the &ldquo;/&rdquo; character by concatenating File.separator, then the subdirectory in which we want to store our file. For our purposes, we used the name of our app.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Finally, we use our contentResolver to insert our values into the MediaStore&rsquo;s index, and store the URI of the newly inserted values in the constant &ldquo;uri.&rdquo; Think of this URI as a sort of abstracted path to the file. It doesn&rsquo;t specify where specifically our file is going to go, but it does provide a path that can be interpreted by the MediaStore, since that location now stores the actual path to the file.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Saving Our File:</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">Now it&rsquo;s time to actually save our file. Here&rsquo;s the code we use to do this:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c7">val </span><span class="c3 c17 c21">outputStream = Objects.requireNonNull(uri)</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;?.</span><span class="c18 c13">let </span><span class="c15">{ </span><span class="c3">resolver.openOutputStream(</span><span class="c15">it</span><span class="c3">) </span><span class="c0">}</span></p><p class="c8"><span class="c3">Thread </span><span class="c0">{</span></p><p class="c8"><span class="c15">&nbsp; &nbsp;</span><span class="c3 c17 c21">saved.compress(</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;Bitmap.CompressFormat.</span><span class="c6">JPEG</span><span class="c7">, </span><span class="c24">100</span><span class="c7 c17 c21">,</span></p><p class="c8"><span class="c7">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3 c17 c21">outputStream</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;)</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c12">/* This must be done within the thread, else things turn out</span></p><p class="c8"><span class="c12">&nbsp; &nbsp; &nbsp; empty which is unideal. */</span></p><p class="c8"><span class="c16">&nbsp; &nbsp;</span><span class="c3 c17 c21">outputStream?.flush()</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;outputStream?.close()</span></p><p class="c8"><span class="c15">}</span><span class="c3 c17 c21">.start()</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">First, we check if our URI is null. If so, we&rsquo;ll receive a NullPointerException, so we&rsquo;ll want to enclose this code within a &ldquo;try&rdquo; block to protect against that. If it isn&rsquo;t null, then we&rsquo;ll open an OutputStream at our URI and store it in outputStream.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Following this, we&rsquo;re ready to write the file. In order to keep from freezing the UI for our user, we&rsquo;ll do this on another thread using the Thread block, which we&rsquo;ll execute with the &ldquo;start&rdquo; call at the end. Within this thread, we call upon the Bitmap.compress method, which will take our Bitmap and compress it to our desired format at the given stream. We&rsquo;ll pass in first the format we want, which we&rsquo;ve already decided is JPEG, then the quality level, and finally our outputStream that we want to write it at. At this point, we&rsquo;ve written our file, but to clean up, we&rsquo;ll finish by closing our stream.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Alternative Method for Older APIs:</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">Before Android 10, things functioned very differently than what you see above, and since many devices in the wild still run pre-10 versions of Android, we need to account for both of these possibilities. First, let&rsquo;s ensure that all the code we&rsquo;ve written so far doesn&rsquo;t execute on older versions of Android where it won&rsquo;t function properly:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c7">if </span><span class="c3">(Build.VERSION.</span><span class="c6">SDK_INT </span><span class="c3">&gt;= Build.VERSION_CODES.</span><span class="c6">Q</span><span class="c3 c17 c21">)</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Enclosing our code in an if block like this means that devices running anything older than Android 10 won&rsquo;t execute our code. Now, let&rsquo;s take a look at what we can put in our else block to do the same thing we&rsquo;ve just done:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c7">else </span><span class="c3 c17 c21">{</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c12">/* Alternative method for older APIs. */</span></p><p class="c8"><span class="c16">&nbsp; &nbsp;</span><span class="c7">val </span><span class="c3">root = Environment.getExternalStoragePublicDirectory(Environment.</span><span class="c6">DIRECTORY_PICTURES</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;.toString() + </span><span class="c14">&quot;/357Project&quot;</span></p><p class="c8"><span class="c22">&nbsp; &nbsp;</span><span class="c7">val </span><span class="c3 c17 c21">directory = File(root)</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;directory.mkdirs()</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c7">val </span><span class="c3">file = File(directory</span><span class="c7">, </span><span class="c22">&quot;TriviaStats_</span><span class="c7">$</span><span class="c3">year</span><span class="c7">$</span><span class="c3">month</span><span class="c7">$</span><span class="c3">day</span><span class="c22">&quot; </span><span class="c3 c17 c21">+</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c22">&quot;_&quot; </span><span class="c3">+ </span><span class="c22">&quot;</span><span class="c7">$</span><span class="c3">hour</span><span class="c7">$</span><span class="c3">minute</span><span class="c7">$</span><span class="c3">second</span><span class="c22">.jpg&quot;</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c16">&nbsp; &nbsp;</span><span class="c7">if </span><span class="c3 c17 c21">(file.exists()) {</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp; &nbsp; &nbsp;file.delete()</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;}</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c7">try </span><span class="c3 c17 c21">{</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">val </span><span class="c3 c17 c21">outputStream = FileOutputStream(file)</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;Thread </span><span class="c0">{</span></p><p class="c8"><span class="c15">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">saved.compress(Bitmap.CompressFormat.</span><span class="c6">JPEG</span><span class="c7">, </span><span class="c24">100</span><span class="c7">, </span><span class="c3 c17 c21">outputStream)</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">val </span><span class="c3">path = MediaStore.Images.Media.insertImage(</span><span class="c7">this</span><span class="c3">.</span><span class="c6">contentResolver</span><span class="c7">, </span><span class="c3">file.</span><span class="c6">path</span><span class="c7">, </span><span class="c3">file.</span><span class="c6">name</span><span class="c7">, null</span><span class="c3">)</span></p><p class="c8"><span class="c16">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3 c17 c21">outputStream.flush()</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;outputStream.close()</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c15">}</span><span class="c3 c17 c21">.start()</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;Toast.makeText(</span><span class="c7">this, </span><span class="c3">getString(R.string.</span><span class="c6">Saved</span><span class="c3">)</span><span class="c7">, </span><span class="c3">Toast.</span><span class="c6">LENGTH_SHORT</span><span class="c3 c17 c21">).show()</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;} </span><span class="c7">catch </span><span class="c3 c17 c21">(exception: Exception) {</span></p><p class="c8"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp;Toast.makeText(</span><span class="c7">this, </span><span class="c3">getString(R.string.</span><span class="c6">Failed_To_Save</span><span class="c3">)</span><span class="c7">, </span><span class="c3">Toast.</span><span class="c6">LENGTH_SHORT</span><span class="c3 c17 c21">).show()</span></p><p class="c8"><span class="c3 c17 c21">&nbsp; &nbsp;}</span></p><p class="c8"><span class="c3 c17 c21">}</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Here, we start by getting our path. Environment.getExternalStoragePublicDirectory will fetch the path to whatever public directory we&rsquo;re looking for, in this case Environment.DIRECTORY_PICTURES, just like we were earlier. We then convert this to a String and concatenate our app name directory just like before.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">From here, we create the directory should it not exist. We create a new File pointing at the path we&rsquo;ve just created. Contrary to its name, File can represent both files and directories. We then call the mkdirs method to actually create the directory.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">From here, we create another File by combining the previous path with our filename, thus pointing directly where we want to store our image. If the file already exists for some reason, we assume we&rsquo;re okay to delete it and do so.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">Now comes the part where we actually do the saving. We open a FileOutputStream where our file is going to be located, then call in the same thread our compress method just like we did before. Only now can we call upon the MediaStore to index our image. We do this with the (now deprecated) insertImage method, which requires we pass in the path to our file, the name of our file, and a description of the file if desired. The first thing we pass in, however, is our ContentResolver, which allows the MediaStore to actually insert the required information. Finally, we do the same flush/close we did before to clean up our streams. </span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c5">You might notice the calls to Toast at the bottom of the try block and within the catch block. This is simply how we decided to handle user feedback for the save operation succeeding/failing. This will put a short message on the screen notifying users of the status of the operation. We used the same method of feedback in our earlier implementation as well.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c4">Accessing Items In Shared Storage:</span></p><p class="c8"><span class="c5">So we have our images stored, but what if our app wants to access it? We&rsquo;ll use this code to do so:</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c7">val </span><span class="c3">i = Intent(Intent.</span><span class="c6">ACTION_VIEW</span><span class="c3 c17 c21">)</span></p><p class="c8"><span class="c3">i.</span><span class="c6">data </span><span class="c3 c17 c21">= Uri.parse(uri)</span></p><p class="c8"><span class="c3 c17 c21">startActivity(i)</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span>First, we create a new Intent and define our action as &ldquo;view.&rdquo; This means it is prepared to view a particular piece of content, in this case our image. Then, we set the data that it is going to view as our image by passing in the URI given to us by the MediaStore, which is what&rsquo;s stored in &ldquo;uri.&rdquo; Finally, we start our intent by calling startActivity.</span></p><p class="c8 c10"><span class="c4"></span></p><p class="c8"><span class="c5">Ultimately, so long as we have that MediaStore URI, it&rsquo;s easy to access any of our media in shared storage.</span></p><p class="c8 c10"><span class="c5"></span></p><p class="c8"><span class="c2 c28">Further Discussions/Conclusions</span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c11 c2">In our tutorial, we described the ways in which we implemented app-specific storage, shared storage, and preferences in order to make a trivia app. For preferences, we explained how to initialize preferences if desired, and how they are used within the app. For app-specific storage, we explained how to read and write files that only our app could see in order to store private data, as well as what we used it for in our app. Finally, for shared storage, we explained how to write and read media files to a public-facing directory accessible by other apps and users outside of our app, as well as what we used it for in our own app. </span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c11 c2">If you would like to create an app that stores even more stats or user data or uses an online database, you may consider implementing a database using Room, which is an android equivalent to a SQLite API. It is a part of the Android Jetpack library and is often used to cache data the user might otherwise not have access to if they are offline.</span></p><p class="c8"><span class="c2">GitHub link: </span><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://github.com/alliefitz22/357Project&amp;sa=D&amp;source=editors&amp;ust=1670624192639859&amp;usg=AOvVaw2UEnCEfVRHGQEgiSGqPv1W">https://github.com/alliefitz22/357Project</a></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c9 c2">References:</span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c11 c2">How we got our head around the breadth of the domain:</span></p><p class="c8"><span class="c2 c27"><a class="c23" href="https://www.google.com/url?q=https://developer.android.com/training/data-storage&amp;sa=D&amp;source=editors&amp;ust=1670624192640703&amp;usg=AOvVaw0TuKbC254mKZXlSjaQ8CYD">https://developer.android.com/training/data-storage</a></span></p><p class="c8"><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://www.youtube.com/watch?v%3DRjyYCUW-9tY&amp;sa=D&amp;source=editors&amp;ust=1670624192640973&amp;usg=AOvVaw1MX4hWAcxvFSx9hXKiR9kt">https://www.youtube.com/watch?v=RjyYCUW-9tY</a></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c11 c2">Source for code to generate images with text on them:</span></p><p class="c8"><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://stackoverflow.com/questions/9124896/generate-a-image-with-custom-text-in-android&amp;sa=D&amp;source=editors&amp;ust=1670624192641365&amp;usg=AOvVaw1Knalm_g5Po-5csOoUQFRj">https://stackoverflow.com/questions/9124896/generate-a-image-with-custom-text-in-android</a></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c11 c2">References used for shared preferences:</span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://developer.android.com/training/data-storage/shared-preferences&amp;sa=D&amp;source=editors&amp;ust=1670624192641979&amp;usg=AOvVaw0F3bRTquJ-IULhVxPO7KNu">https://developer.android.com/training/data-storage/shared-preferences</a></span><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://www.geeksforgeeks.org/shared-preferences-in-android-with-examples/&amp;sa=D&amp;source=editors&amp;ust=1670624192642177&amp;usg=AOvVaw3436ZtihpJZL7LMNwm6Oro">https://www.geeksforgeeks.org/shared-preferences-in-android-with-examples/</a></span></p><p class="c8"><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://developer.android.com/reference/android/content/SharedPreferences&amp;sa=D&amp;source=editors&amp;ust=1670624192642442&amp;usg=AOvVaw3jbKQT6ENf-GLxSlGuYzdt">https://developer.android.com/reference/android/content/SharedPreferences</a></span></p><p class="c8"><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://abhiandroid.com/programming/shared-preference&amp;sa=D&amp;source=editors&amp;ust=1670624192642692&amp;usg=AOvVaw0nTyNgV5OXzqQQhdhHpDEa">https://abhiandroid.com/programming/shared-preference</a></span></p><p class="c8 c10"><span class="c11 c2"></span></p><p class="c8"><span class="c2">Source for our questions (taken from the most recent Who Wants To Be A Millionaire video game): </span><span class="c27 c2"><a class="c23" href="https://www.google.com/url?q=https://docs.google.com/spreadsheets/d/1jMxqejEEYQd8u4jad-huxCZ_gDmbm-d-EBWzg6okWAA/edit%23gid%3D1550830069&amp;sa=D&amp;source=editors&amp;ust=1670624192643148&amp;usg=AOvVaw0Pst8iJLhZgaOO3m7EAd9b">https://docs.google.com/spreadsheets/d/1jMxqejEEYQd8u4jad-huxCZ_gDmbm-d-EBWzg6okWAA/edit#gid=1550830069</a></span></p><p class="c8 c10"><span class="c11 c2"></span></p></body></html>